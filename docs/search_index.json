[["statistical-genetics.html", "4 Statistical Genetics 4.1 Phasing 4.2 Kinship 4.3 Runs of Homozygosity 4.4 Linkage Analysis 4.5 Population Substructure", " 4 Statistical Genetics 4.1 Phasing We use WhatsHap to phase genotypes in a pedigree using the Mendelian transmission rules and physical phasing based on reads that span two or more heterozygous variants. whatshap phase --ped pedigree.ped \\ -o phased_whatshap.vcf joint/output_vqsr_variants.vcf.gz \\ aligned_HG002.bam aligned_HG003.bam aligned_HG004.bam \\ --tag=PS --no-reference --indels 4.2 Kinship We seek to verify pedigree relationships and identify hidden relatedness between samples. We first select SNPs in approximate linkage equilibrium with Linkdatagen based on the genetic linkage map of HapMap SNPs. Linkdatagen also eliminates Mendelian inconsitencies in the data. # Split variant calling file into seperate files for each individual bcftools +split AJ_output_vqsr_snps_hard_indels.vcf.gz -Ov -o split # Write path to each individual&#39;s vcf in a text file named MyVCFlist.txt perl vcf2linkdatagen.pl \\ -variantCaller unifiedgenotyper \\ -annotfile annotHapMap2U_hg38.txt \\ -pop CEU -mindepth 10 -missingness 0 \\ -idlist MyVCFlist.txt &gt; HG002_trio.brlmm perl linkdatagen.pl \\ -data m -pedfile MyPed.ped \\ -whichSamplesFile MyWS.ws \\ -callFile MySNPs.brlmm \\ -annotFile annotHapMap2U.txt \\ -pop CEU -binsize 0.3 \\ -MendelErrors removeSNPs -prog pl \\ -outputDir MyPed_HapMap2_pl &gt; MyPed_HapMap2_pl.out We construct an allele frequency report for the chosen SNPs. library(tidyverse) map &lt;- read_delim(file = &quot;data/plink.map&quot;, delim = &quot; &quot;, col_select = 1:4, col_names = c(&quot;CHR&quot;, &quot;SNP&quot;, &quot;cM&quot;, &quot;bp&quot;)) ord &lt;- read_tsv(file = &quot;data/orderedSNPs.txt&quot;) freq_pl &lt;- map %&gt;% left_join(ord, by = &quot;SNP&quot;) %&gt;% dplyr::select(CHR, SNP, `Allele freq`) %&gt;% mutate(A1=&quot;1&quot;) %&gt;% mutate(A2=&quot;2&quot;) %&gt;% mutate(NCHROBS=&quot;300&quot;) %&gt;% dplyr::select(CHR, SNP, A1, A2, `Allele freq`, NCHROBS) %&gt;% dplyr::rename(MAF = `Allele freq`) write_delim(freq_pl, &quot;result/freq_pl.frq&quot;, delim = &quot; &quot;) ## Warning: package &#39;rmarkdown&#39; was built under R version 4.3.1 Alternatively, with a sufficient number of samples, we can estimate the linkage disequilibrium between alleles and remove correlated SNPs using PLINK. plink --file data --indep 50 5 2 We then calculate the empirical kinship coefficient by estimating identity by descent based on identity by state and population allele frequencies (Lange 2002). We run this calculation in PLINK. module load plink/1.9b_6.21-x86_64 plink --file plink --genome full --read-freq freq_pl.frq We also run this calculation using MendelKinship from the OpenMendel project. using MendelKinship, CSV Kinship(&quot;control_compare.txt&quot;) We obtain the following results for the AJ reference trio using PLINK. PI_HAT is two times the estimated kinship coefficient between individuals IID1 and IID2. We note that the estimated kinship coefficient between individuals HG003 and HG004, which equals the the inbreeding coefficient of their son HG002, is 0. IID1 IID2 RT EZ Z0 Z1 Z2 PI_HAT DST IBS0 IBS1 IBS2 HG002 HG003 PO 0.5 0 1 0 0.5 0.752334 0 2918 2973 HG002 HG004 PO 0.5 0 1 0 0.5 0.756153 0 2873 3018 HG003 HG004 OT 0 1 0 0 0 0.616449 638 3243 2010 4.3 Runs of Homozygosity If we suspect some degree of consanguinity, we may look for a homozygous pathogenic variant in runs of homozygosity using AutozygosityMapper. AutozygosityMapper report for HG002 as case and HG003 and HG004 as controls. 4.4 Linkage Analysis Using the same set of SNPs in linkage equillibrium, we can run linkage analysis on appropriately chosen pedigrees using OpenMendel for two-point linkage or multipoint linkage analysis. # Two-point linkage analysis using MendelTwoPointLinkage, CSV TwoPointLinkage(&quot;Control_file.txt&quot;) # Multipoint linkage analysis using MendelLocationScores, CSV LocationScores(&quot;Control_file.txt&quot;) 4.5 Population Substructure Given a large number of samples from a population, we cluster individuals by degree of identity by state using PLINK in order to identify subgroups with shared ancestry. plink --file mydata --cluster # dimensional reduction to 4D then plot two coordinates plink --file mydata --read-genome plink.genome --cluster --mds-plot 4 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
